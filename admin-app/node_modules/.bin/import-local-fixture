#!/bin/sh

# Get the basedir using realpath for portability
if command -v realpath &>/dev/null; then
  basedir=$(realpath "$(dirname "$0")")
elif command -v python3 &>/dev/null; then
  basedir=$(python3 -c "import os; print(os.path.realpath('$0').decode('utf-8'))")
else
  echo "Error: Unable to determine the basedir. Please install realpath or python3."
  exit 1
fi

# Use node_modules/.bin/node if available to prioritize local node over system node
NODE_BIN=$(command -v node_modules/.bin/node 2>/dev/null || command -v node)

if [ -x "$basedir/node_modules/.bin/node" ]; then
  exec "$basedir/node_modules/.bin/node" "$basedir/../import-local/fixtures/cli.js" "$@"
elif [ -x "$basedir/node" ]; then
  exec "$basedir/node" "$basedir/../import-local/fixtures/cli.js" "$@"
else
  exec "$NODE_BIN" "$basedir/../import-local/fixtures/cli.js" "$@"
fi

