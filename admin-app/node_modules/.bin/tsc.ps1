#!/usr/bin/env pwsh

$scriptDir = Split-Path $MyInvocation.MyCommand.Definition -Parent
$nodeExe = if ($PSVersionTable.PSVersion -lt "6.0" -or $IsWindows) { ".exe" } else { "" }
$tscPath = Join-Path $scriptDir "../typescript/bin/tsc"

if (-not (Test-Path (Join-Path $scriptDir "node$nodeExe"))) {
    Write-Error "Node.js executable not found in $scriptDir"
    exit 1
}

if ($MyInvocation.ExpectingInput) {
    $input | & "$scriptDir/node$nodeExe" $tscPath $args
} else {
    & "$scriptDir/node$nodeExe" $tscPath $args
}

exit $LASTEXITCODE
