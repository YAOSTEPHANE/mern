#!/bin/sh

# Get the basedir using realpath for portability
if command -v realpath &>/dev/null; then
  basedir=$(realpath "$(dirname "$0")")
elif command -v python3 &>/dev/null; then
  basedir=$(python3 -c "import os; print(os.path.realpath('$0').decode('utf-8'))")
else
  echo "Error: Unable to determine the basedir. Please install realpath or python3."
  exit 1
fi

# Use cygpath to convert the path to Windows format on Cygwin, Mingw, or MSYS
case `uname` in
    *CYGWIN*|*MINGW*|*MSYS*)
        basedir=$(cygpath -w "$basedir")
        ;;
esac

# Check if node is available in the basedir, otherwise use the system-wide node
if [ -x "$basedir/node" ]; then
  exec "$basedir/node"  "$basedir/../js-yaml/bin/js-yaml.js" "$@"
else
  if command -v node &>/dev/null; then
    exec node  "$basedir/../js-yaml/bin/js-yaml.js" "$@"
  else
    echo "Error: Node.js not found. Please install Node.js and try again."
    exit 1
  fi
fi
