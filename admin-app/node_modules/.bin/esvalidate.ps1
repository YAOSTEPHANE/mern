#!/usr/bin/env pwsh

$scriptDir = Split-Path $MyInvocation.MyCommand.Definition -Parent
$nodeExe = if ($PSVersionTable.PSVersion -lt "6.0" -or $IsWindows) { ".exe" } else { "" }
$esvalidate = "$scriptDir/../esprima/bin/esvalidate.js"

if (-not (Test-Path "$scriptDir/node$nodeExe")) {
    Write-Error "Node.js executable not found in $scriptDir"
    exit 1
}

if ($MyInvocation.ExpectingInput) {
    $input | & "$scriptDir/node$nodeExe" $esvalidate $args
} else {
    & "$scriptDir/node$nodeExe" $esvalidate $args
}

exit $LASTEXITCODE
