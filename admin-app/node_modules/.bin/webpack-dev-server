#!/bin/sh

# Get the basedir using absolute path to avoid issues with relative paths
basedir=$(readlink -f "$(dirname "$0")")

# Use case statement to determine if the current operating system is Windows
# and convert the path accordingly using cygpath
case $(uname) in
    *CYGWIN*|*MINGW*|*MSYS*)
        basedir=$(cygpath -w -- "$basedir")
    ;;
esac

# Check if the basedir/node executable exists and execute it with the webpack-dev-server
if [ -x "$basedir/node" ]; then
  exec "$basedir/node" "$basedir/../webpack-dev-server/bin/webpack-dev-server.js" "$@"
# If not, check if the node executable exists and execute it with the webpack-dev-server
elif [ -x "$(command -v node)" ]; then
  exec node "$basedir/../webpack-dev-server/bin/webpack-dev-server.js" "$@"
# If neither exists, print an error message and exit
else
  echo "Error: node or basedir/node not found." >&2
  exit 1
fi
