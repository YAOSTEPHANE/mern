#!/usr/bin/env pwsh

$scriptDir = Split-Path $MyInvocation.MyCommand.Definition -Parent
$nodeExe = if ($PSVersionTable.PSVersion -lt "6.0" -or $IsWindows) {
    "$scriptDir/node.exe"
} else {
    "node"
}

if (-not (Test-Path $nodeExe)) {
    Write-Error "Node.js executable not found. Please ensure Node.js is installed and the 'node' command is in your PATH."
    exit 1
}

$cliJs = Join-Path $scriptDir "../multicast-dns/cli.js"

if ($MyInvocation.ExpectingInput) {
    $input | & $nodeExe $cliJs $args
} else {
    & $nodeExe $cliJs $args
}

exit $LASTEXITCODE
