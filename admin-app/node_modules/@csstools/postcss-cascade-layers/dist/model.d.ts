import { AtRule } from 'postcss';

export class Model {
  anonymousLayerCount: number = 0;
  layerCount: number = 0;
  layerOrder: Map<string, number> = new Map();
  layerParamsParsed: Map<string, string[]> = new Map();
  layerNameParts: Map<string, string[]> = new Map();

  constructor() {
    this.createAnonymousLayerName = this.createAnonymousLayerName.bind(this);
    this.createImplicitLayerName = this.createImplicitLayerName.bind(this);
    this.addLayerParams = this.addLayerParams.bind(this);
    this.addLayerNameParts = this.addLayerNameParts.bind(this);
    this.getLayerParams = this.getLayerParams.bind(this);
    this.getLayerNameList = this.getLayerNameList.bind(this);
    this.sortLayerNames = this.sortLayerNames.bind(this);
  }

  createAnonymousLayerName(): string {
    this.anonymousLayerCount++;
    return `Anonymous-${this.anonymousLayerCount}`;
  }

  createImplicitLayerName(layerName: string): string {
    this.layerCount++;
    this.layerOrder.set(layerName, this.layerCount);
    return layerName;
  }

  addLayerParams(key: string, parts?: string | string[]): void {
    if (parts === undefined) {
      parts = key;
      key = '';
    }
    if (Array.isArray(parts)) {
      this.layerParamsParsed.set(key, parts);
    } else {
      this.layerParamsParsed.set(key, parts.split(' '));
    }
  }

  addLayerNameParts(parts: string | string[]): void {
    if (Array.isArray(parts)) {
      this.layerNameParts.set('', parts);
    } else {
      this.layerNameParts.set('', parts.split(' '));
    }
  }
